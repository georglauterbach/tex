%   ┌───────────────────────────────────────────────────────┐
%   |
% ? | Loads packages that need to be loaded at the end.
% ? | Also applies patches.
%   |
% ! | Must be loaded last.
% ! | Should generally be loaded.
%   |
%   └───────────────────────────────────────────────────────┘

% ? >> patches

% https://tex.stackexchange.com/questions/328128/strange-behaviour-in-biblatex-online-without-year
\usepackage{xpatch}
\xpatchbibdriver{online}
{\printtext[parens]{\usebibmacro{date}}}
{\iffieldundef{year}{}{\printtext[parens]{\usebibmacro{date}}}}
{}{}

% ? > loaded last

\usepackage[autostyle]{csquotes}
\usepackage[nameinlink,noabbrev]{cleveref}

\ifenglish%

\crefname{subsection}{section}{sections}
\crefname{subsubsection}{subsection}{subsections}
\crefname{paragraph}{paragraph}{paragraphs}

\ifframesloaded%

\crefname{definition}{definition}{definitions}
\crefname{lemma}{lemma}{lemmas}
\crefname{axiom}{axiom}{axioms}
\crefname{notation}{notation}{notations}
\crefname{problem}{problem}{problems}

\crefname{theorem}{theorem}{theorems}
\crefname{corollary}{corollary}{corollaries}
\crefname{proof}{proof}{proofs}
\crefname{example}{example}{examples}

\fi% ifframesloaded

\else% ifenglish

\crefname{subsection}{Sektion}{Sektionen}
\crefname{subsubsection}{Untersektion}{Untersektionen}
\crefname{paragraph}{Paragraph}{Paragraphen}

\ifframesloaded%

\crefname{definition}{Definition}{Definitionen}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{axiom}{Axiom}{Axiome}
\crefname{notation}{Notation}{Notationen}
\crefname{problem}{Problem}{Probleme}

\crefname{theorem}{Satz}{Sätze}
\crefname{corollary}{Korellar}{Korellare}
\crefname{proof}{Beweis}{Beweise}
\crefname{example}{Beispiel}{Beispiele}

\fi% ifframesloaded

\fi% ifenglish

\ifframesloaded%

\let\oldLemma\lemma
\renewcommand{\lemma}{\crefalias{definition}{lemma}\oldLemma}

\let\oldAxiom\axiom
\renewcommand{\axiom}{\crefalias{definition}{axiom}\oldAxiom}

\let\oldNotation\notation
\renewcommand{\notation}{\crefalias{definition}{notation}\oldNotation}

\let\oldProblem\problem
\renewcommand{\problem}{\crefalias{definition}{problem}\oldProblem}

\let\oldTheorem\theorem
\renewcommand{\theorem}{\crefalias{definition}{theorem}\oldTheorem}

\let\oldCorollary\corollary
\renewcommand{\corollary}{\crefalias{definition}{corollary}\oldCorollary}

\let\oldProof\proof
\renewcommand{\proof}{\crefalias{definition}{proof}\oldProof}

\let\oldExample\example
\renewcommand{\example}{\crefalias{definition}{example}\oldExample}

\fi% ifframesloaded
